```python
# this script contains two parts:
# 1. Extract the pediatric population count in each age group (Final age range: 0-9, 10-14, 15-17, 18-21) from Zip Code 
# Tabulation Areas (ZCTA), also for each race (White, Black, Hispanic, Asian, Native Americans)
# 2. Clean the Area Deprivation Index (ADI) data (9-digit zip code level data), calculate the average ZIP Code-level ADI from all 9-digit ZIP Code-level estimates 
# within a given 5-digit ZIP Code (ref), append the result of each state together
import pandas as pd

df = pd.read_csv(r'C:\Users\u6037208\Box\Pediatric_Cancer_care\National pediatric cancer care locations\GIS_analysis\ZCTA_demographics\Age_n_Sex_1.csv')

print(len(list(df.columns)))


```

    610
    


```python
margin_cols = [col for col in df.columns if 'm' in col]

print(margin_cols)
```

    ['B01001Cm9', 'B01001Cm10', 'B01001Cm11', 'B01001Cm12', 'B01001Cm13', 'B01001Cm14', 'B01001Cm15', 'B01001Cm16', 'B01001Cm17', 'B01001Cm18', 'B01001Cm19', 'B01001Cm20', 'B01001Cm21', 'B01001Cm22', 'B01001Cm23', 'B01001Cm24', 'B01001Cm25', 'B01001Cm26', 'B01001Cm27', 'B01001Cm28', 'B01001Cm29', 'B01001Cm30', 'B01001Cm31', 'B01001Dm1', 'B01001Dm2', 'B01001Dm3', 'B01001Dm4', 'B01001Dm5', 'B01001Dm6', 'B01001Dm7', 'B01001Dm8', 'B01001Dm9', 'B01001Dm10', 'B01001Dm11', 'B01001Dm12', 'B01001Dm13', 'B01001Dm14', 'B01001Dm15', 'B01001Dm16', 'B01001Dm17', 'B01001Dm18', 'B01001Dm19', 'B01001Dm20', 'B01001Dm21', 'B01001Dm22', 'B01001Dm23', 'B01001Dm24', 'B01001Dm25', 'B01001Dm26', 'B01001Dm27', 'B01001Dm28', 'B01001Dm29', 'B01001Dm30', 'B01001Dm31', 'B01001Em1', 'B01001Em2', 'B01001Em3', 'B01001Em4', 'B01001Em5', 'B01001Em6', 'B01001Em7', 'B01001Em8', 'B01001Em9', 'B01001Em10', 'B01001Em11', 'B01001Em12', 'B01001Em13', 'B01001Em14', 'B01001Em15', 'B01001Em16', 'B01001Em17', 'B01001Em18', 'B01001Em19', 'B01001Em20', 'B01001Em21', 'B01001Em22', 'B01001Em23', 'B01001Em24', 'B01001Em25', 'B01001Em26', 'B01001Em27', 'B01001Em28', 'B01001Em29', 'B01001Em30', 'B01001Em31', 'B01001Fm1', 'B01001Fm2', 'B01001Fm3', 'B01001Fm4', 'B01001Fm5', 'B01001Fm6', 'B01001Fm7', 'B01001Fm8', 'B01001Fm9', 'B01001Fm10', 'B01001Fm11', 'B01001Fm12', 'B01001Fm13', 'B01001Fm14', 'B01001Fm15', 'B01001Fm16', 'B01001Fm17', 'B01001Fm18', 'B01001Fm19', 'B01001Fm20', 'B01001Fm21', 'B01001Fm22', 'B01001Fm23', 'B01001Fm24', 'B01001Fm25', 'B01001Fm26', 'B01001Fm27', 'B01001Fm28', 'B01001Fm29', 'B01001Fm30', 'B01001Fm31', 'B01001Gm1', 'B01001Gm2', 'B01001Gm3', 'B01001Gm4', 'B01001Gm5', 'B01001Gm6', 'B01001Gm7', 'B01001Gm8', 'B01001Gm9', 'B01001Gm10', 'B01001Gm11', 'B01001Gm12', 'B01001Gm13', 'B01001Gm14', 'B01001Gm15', 'B01001Gm16', 'B01001Gm17', 'B01001Gm18', 'B01001Gm19', 'B01001Gm20', 'B01001Gm21', 'B01001Gm22', 'B01001Gm23', 'B01001Gm24', 'B01001Gm25', 'B01001Gm26', 'B01001Gm27', 'B01001Gm28', 'B01001Gm29', 'B01001Gm30', 'B01001Gm31', 'B01001Hm1', 'B01001Hm2', 'B01001Hm3', 'B01001Hm4', 'B01001Hm5', 'B01001Hm6', 'B01001Hm7', 'B01001Hm8', 'B01001Hm9', 'B01001Hm10', 'B01001Hm11', 'B01001Hm12', 'B01001Hm13', 'B01001Hm14', 'B01001Hm15', 'B01001Hm16', 'B01001Hm17', 'B01001Hm18', 'B01001Hm19', 'B01001Hm20', 'B01001Hm21', 'B01001Hm22', 'B01001Hm23', 'B01001Hm24', 'B01001Hm25', 'B01001Hm26', 'B01001Hm27', 'B01001Hm28', 'B01001Hm29', 'B01001Hm30', 'B01001Hm31', 'B01001Im1', 'B01001Im2', 'B01001Im3', 'B01001Im4', 'B01001Im5', 'B01001Im6', 'B01001Im7', 'B01001Im8', 'B01001Im9', 'B01001Im10', 'B01001Im11', 'B01001Im12', 'B01001Im13', 'B01001Im14', 'B01001Im15', 'B01001Im16', 'B01001Im17', 'B01001Im18', 'B01001Im19', 'B01001Im20', 'B01001Im21', 'B01001Im22', 'B01001Im23', 'B01001Im24', 'B01001Im25', 'B01001Im26', 'B01001Im27', 'B01001Im28', 'B01001Im29', 'B01001Im30', 'B01001Im31', 'B01002m1', 'B01002m2', 'B01002m3', 'B01002Am1', 'B01002Am2', 'B01002Am3', 'B01002Bm1', 'B01002Bm2', 'B01002Bm3', 'B01002Cm1', 'B01002Cm2', 'B01002Cm3', 'B01002Dm1', 'B01002Dm2', 'B01002Dm3', 'B01002Em1', 'B01002Em2', 'B01002Em3', 'B01002Fm1', 'B01002Fm2', 'B01002Fm3', 'B01002Gm1', 'B01002Gm2', 'B01002Gm3', 'B01002Hm1', 'B01002Hm2', 'B01002Hm3', 'B01002Im1', 'B01002Im2', 'B01002Im3', 'B01003m1']
    


```python
# exclude the margin of error columns
# estimate_cols = df.loc[:, ~df.columns.isin(margin_cols)]


df1 = df.drop(margin_cols, axis=1)
print(list(df1.columns))
```

    ['OBJECTID', 'GEOID', 'B01001e1', 'B01001e2', 'B01001e3', 'B01001e4', 'B01001e5', 'B01001e6', 'B01001e7', 'B01001e8', 'B01001e9', 'B01001e10', 'B01001e11', 'B01001e12', 'B01001e13', 'B01001e14', 'B01001e15', 'B01001e16', 'B01001e17', 'B01001e18', 'B01001e19', 'B01001e20', 'B01001e21', 'B01001e22', 'B01001e23', 'B01001e24', 'B01001e25', 'B01001e26', 'B01001e27', 'B01001e28', 'B01001e29', 'B01001e30', 'B01001e31', 'B01001e32', 'B01001e33', 'B01001e34', 'B01001e35', 'B01001e36', 'B01001e37', 'B01001e38', 'B01001e39', 'B01001e40', 'B01001e41', 'B01001e42', 'B01001e43', 'B01001e44', 'B01001e45', 'B01001e46', 'B01001e47', 'B01001e48', 'B01001e49', 'B01001Ae1', 'B01001Ae2', 'B01001Ae3', 'B01001Ae4', 'B01001Ae5', 'B01001Ae6', 'B01001Ae7', 'B01001Ae8', 'B01001Ae9', 'B01001Ae10', 'B01001Ae11', 'B01001Ae12', 'B01001Ae13', 'B01001Ae14', 'B01001Ae15', 'B01001Ae16', 'B01001Ae17', 'B01001Ae18', 'B01001Ae19', 'B01001Ae20', 'B01001Ae21', 'B01001Ae22', 'B01001Ae23', 'B01001Ae24', 'B01001Ae25', 'B01001Ae26', 'B01001Ae27', 'B01001Ae28', 'B01001Ae29', 'B01001Ae30', 'B01001Ae31', 'B01001Be1', 'B01001Be2', 'B01001Be3', 'B01001Be4', 'B01001Be5', 'B01001Be6', 'B01001Be7', 'B01001Be8', 'B01001Be9', 'B01001Be10', 'B01001Be11', 'B01001Be12', 'B01001Be13', 'B01001Be14', 'B01001Be15', 'B01001Be16', 'B01001Be17', 'B01001Be18', 'B01001Be19', 'B01001Be20', 'B01001Be21', 'B01001Be22', 'B01001Be23', 'B01001Be24', 'B01001Be25', 'B01001Be26', 'B01001Be27', 'B01001Be28', 'B01001Be29', 'B01001Be30', 'B01001Be31', 'B01001Ce1', 'B01001Ce2', 'B01001Ce3', 'B01001Ce4', 'B01001Ce5', 'B01001Ce6', 'B01001Ce7', 'B01001Ce8', 'B01001Ce9', 'B01001Ce10', 'B01001Ce11', 'B01001Ce12', 'B01001Ce13', 'B01001Ce14', 'B01001Ce15', 'B01001Ce16', 'B01001Ce17', 'B01001Ce18', 'B01001Ce19', 'B01001Ce20', 'B01001Ce21', 'B01001Ce22', 'B01001Ce23', 'B01001Ce24', 'B01001Ce25', 'B01001Ce26', 'B01001Ce27', 'B01001Ce28', 'B01001Ce29', 'B01001Ce30', 'B01001Ce31', 'B01001De1', 'B01001De2', 'B01001De3', 'B01001De4', 'B01001De5', 'B01001De6', 'B01001De7', 'B01001De8', 'B01001De9', 'B01001De10', 'B01001De11', 'B01001De12', 'B01001De13', 'B01001De14', 'B01001De15', 'B01001De16', 'B01001De17', 'B01001De18', 'B01001De19', 'B01001De20', 'B01001De21', 'B01001De22', 'B01001De23', 'B01001De24', 'B01001De25', 'B01001De26', 'B01001De27', 'B01001De28', 'B01001De29', 'B01001De30', 'B01001De31', 'B01001Ee1', 'B01001Ee2', 'B01001Ee3', 'B01001Ee4', 'B01001Ee5', 'B01001Ee6', 'B01001Ee7', 'B01001Ee8', 'B01001Ee9', 'B01001Ee10', 'B01001Ee11', 'B01001Ee12', 'B01001Ee13', 'B01001Ee14', 'B01001Ee15', 'B01001Ee16', 'B01001Ee17', 'B01001Ee18', 'B01001Ee19', 'B01001Ee20', 'B01001Ee21', 'B01001Ee22', 'B01001Ee23', 'B01001Ee24', 'B01001Ee25', 'B01001Ee26', 'B01001Ee27', 'B01001Ee28', 'B01001Ee29', 'B01001Ee30', 'B01001Ee31', 'B01001Fe1', 'B01001Fe2', 'B01001Fe3', 'B01001Fe4', 'B01001Fe5', 'B01001Fe6', 'B01001Fe7', 'B01001Fe8', 'B01001Fe9', 'B01001Fe10', 'B01001Fe11', 'B01001Fe12', 'B01001Fe13', 'B01001Fe14', 'B01001Fe15', 'B01001Fe16', 'B01001Fe17', 'B01001Fe18', 'B01001Fe19', 'B01001Fe20', 'B01001Fe21', 'B01001Fe22', 'B01001Fe23', 'B01001Fe24', 'B01001Fe25', 'B01001Fe26', 'B01001Fe27', 'B01001Fe28', 'B01001Fe29', 'B01001Fe30', 'B01001Fe31', 'B01001Ge1', 'B01001Ge2', 'B01001Ge3', 'B01001Ge4', 'B01001Ge5', 'B01001Ge6', 'B01001Ge7', 'B01001Ge8', 'B01001Ge9', 'B01001Ge10', 'B01001Ge11', 'B01001Ge12', 'B01001Ge13', 'B01001Ge14', 'B01001Ge15', 'B01001Ge16', 'B01001Ge17', 'B01001Ge18', 'B01001Ge19', 'B01001Ge20', 'B01001Ge21', 'B01001Ge22', 'B01001Ge23', 'B01001Ge24', 'B01001Ge25', 'B01001Ge26', 'B01001Ge27', 'B01001Ge28', 'B01001Ge29', 'B01001Ge30', 'B01001Ge31', 'B01001He1', 'B01001He2', 'B01001He3', 'B01001He4', 'B01001He5', 'B01001He6', 'B01001He7', 'B01001He8', 'B01001He9', 'B01001He10', 'B01001He11', 'B01001He12', 'B01001He13', 'B01001He14', 'B01001He15', 'B01001He16', 'B01001He17', 'B01001He18', 'B01001He19', 'B01001He20', 'B01001He21', 'B01001He22', 'B01001He23', 'B01001He24', 'B01001He25', 'B01001He26', 'B01001He27', 'B01001He28', 'B01001He29', 'B01001He30', 'B01001He31', 'B01001Ie1', 'B01001Ie2', 'B01001Ie3', 'B01001Ie4', 'B01001Ie5', 'B01001Ie6', 'B01001Ie7', 'B01001Ie8', 'B01001Ie9', 'B01001Ie10', 'B01001Ie11', 'B01001Ie12', 'B01001Ie13', 'B01001Ie14', 'B01001Ie15', 'B01001Ie16', 'B01001Ie17', 'B01001Ie18', 'B01001Ie19', 'B01001Ie20', 'B01001Ie21', 'B01001Ie22', 'B01001Ie23', 'B01001Ie24', 'B01001Ie25', 'B01001Ie26', 'B01001Ie27', 'B01001Ie28', 'B01001Ie29', 'B01001Ie30', 'B01001Ie31', 'B01002e1', 'B01002e2', 'B01002e3', 'B01002Ae1', 'B01002Ae2', 'B01002Ae3', 'B01002Be1', 'B01002Be2', 'B01002Be3', 'B01002Ce1', 'B01002Ce2', 'B01002Ce3', 'B01002De1', 'B01002De2', 'B01002De3', 'B01002Ee1', 'B01002Ee2', 'B01002Ee3', 'B01002Fe1', 'B01002Fe2', 'B01002Fe3', 'B01002Ge1', 'B01002Ge2', 'B01002Ge3', 'B01002He1', 'B01002He2', 'B01002He3', 'B01002Ie1', 'B01002Ie2', 'B01002Ie3', 'B01003e1', 'M_0_9', 'M_10_14', 'M_15_17', 'M_18_21', 'F_0_9', 'F_10_14', 'F_15_17', 'F_18_21', 'ZCTA']
    


```python
df1["M_0_21"] = df1['M_0_9']+  df1['M_10_14']+ df1['M_15_17'] + df1['M_18_21']
df1["F_0_21"] = df1['F_0_9']+  df1['F_10_14']+ df1['F_15_17'] + df1['F_18_21']
print(list(df1.columns))
```

    ['OBJECTID', 'GEOID', 'B01001e1', 'B01001e2', 'B01001e3', 'B01001e4', 'B01001e5', 'B01001e6', 'B01001e7', 'B01001e8', 'B01001e9', 'B01001e10', 'B01001e11', 'B01001e12', 'B01001e13', 'B01001e14', 'B01001e15', 'B01001e16', 'B01001e17', 'B01001e18', 'B01001e19', 'B01001e20', 'B01001e21', 'B01001e22', 'B01001e23', 'B01001e24', 'B01001e25', 'B01001e26', 'B01001e27', 'B01001e28', 'B01001e29', 'B01001e30', 'B01001e31', 'B01001e32', 'B01001e33', 'B01001e34', 'B01001e35', 'B01001e36', 'B01001e37', 'B01001e38', 'B01001e39', 'B01001e40', 'B01001e41', 'B01001e42', 'B01001e43', 'B01001e44', 'B01001e45', 'B01001e46', 'B01001e47', 'B01001e48', 'B01001e49', 'B01001Ae1', 'B01001Ae2', 'B01001Ae3', 'B01001Ae4', 'B01001Ae5', 'B01001Ae6', 'B01001Ae7', 'B01001Ae8', 'B01001Ae9', 'B01001Ae10', 'B01001Ae11', 'B01001Ae12', 'B01001Ae13', 'B01001Ae14', 'B01001Ae15', 'B01001Ae16', 'B01001Ae17', 'B01001Ae18', 'B01001Ae19', 'B01001Ae20', 'B01001Ae21', 'B01001Ae22', 'B01001Ae23', 'B01001Ae24', 'B01001Ae25', 'B01001Ae26', 'B01001Ae27', 'B01001Ae28', 'B01001Ae29', 'B01001Ae30', 'B01001Ae31', 'B01001Be1', 'B01001Be2', 'B01001Be3', 'B01001Be4', 'B01001Be5', 'B01001Be6', 'B01001Be7', 'B01001Be8', 'B01001Be9', 'B01001Be10', 'B01001Be11', 'B01001Be12', 'B01001Be13', 'B01001Be14', 'B01001Be15', 'B01001Be16', 'B01001Be17', 'B01001Be18', 'B01001Be19', 'B01001Be20', 'B01001Be21', 'B01001Be22', 'B01001Be23', 'B01001Be24', 'B01001Be25', 'B01001Be26', 'B01001Be27', 'B01001Be28', 'B01001Be29', 'B01001Be30', 'B01001Be31', 'B01001Ce1', 'B01001Ce2', 'B01001Ce3', 'B01001Ce4', 'B01001Ce5', 'B01001Ce6', 'B01001Ce7', 'B01001Ce8', 'B01001Ce9', 'B01001Ce10', 'B01001Ce11', 'B01001Ce12', 'B01001Ce13', 'B01001Ce14', 'B01001Ce15', 'B01001Ce16', 'B01001Ce17', 'B01001Ce18', 'B01001Ce19', 'B01001Ce20', 'B01001Ce21', 'B01001Ce22', 'B01001Ce23', 'B01001Ce24', 'B01001Ce25', 'B01001Ce26', 'B01001Ce27', 'B01001Ce28', 'B01001Ce29', 'B01001Ce30', 'B01001Ce31', 'B01001De1', 'B01001De2', 'B01001De3', 'B01001De4', 'B01001De5', 'B01001De6', 'B01001De7', 'B01001De8', 'B01001De9', 'B01001De10', 'B01001De11', 'B01001De12', 'B01001De13', 'B01001De14', 'B01001De15', 'B01001De16', 'B01001De17', 'B01001De18', 'B01001De19', 'B01001De20', 'B01001De21', 'B01001De22', 'B01001De23', 'B01001De24', 'B01001De25', 'B01001De26', 'B01001De27', 'B01001De28', 'B01001De29', 'B01001De30', 'B01001De31', 'B01001Ee1', 'B01001Ee2', 'B01001Ee3', 'B01001Ee4', 'B01001Ee5', 'B01001Ee6', 'B01001Ee7', 'B01001Ee8', 'B01001Ee9', 'B01001Ee10', 'B01001Ee11', 'B01001Ee12', 'B01001Ee13', 'B01001Ee14', 'B01001Ee15', 'B01001Ee16', 'B01001Ee17', 'B01001Ee18', 'B01001Ee19', 'B01001Ee20', 'B01001Ee21', 'B01001Ee22', 'B01001Ee23', 'B01001Ee24', 'B01001Ee25', 'B01001Ee26', 'B01001Ee27', 'B01001Ee28', 'B01001Ee29', 'B01001Ee30', 'B01001Ee31', 'B01001Fe1', 'B01001Fe2', 'B01001Fe3', 'B01001Fe4', 'B01001Fe5', 'B01001Fe6', 'B01001Fe7', 'B01001Fe8', 'B01001Fe9', 'B01001Fe10', 'B01001Fe11', 'B01001Fe12', 'B01001Fe13', 'B01001Fe14', 'B01001Fe15', 'B01001Fe16', 'B01001Fe17', 'B01001Fe18', 'B01001Fe19', 'B01001Fe20', 'B01001Fe21', 'B01001Fe22', 'B01001Fe23', 'B01001Fe24', 'B01001Fe25', 'B01001Fe26', 'B01001Fe27', 'B01001Fe28', 'B01001Fe29', 'B01001Fe30', 'B01001Fe31', 'B01001Ge1', 'B01001Ge2', 'B01001Ge3', 'B01001Ge4', 'B01001Ge5', 'B01001Ge6', 'B01001Ge7', 'B01001Ge8', 'B01001Ge9', 'B01001Ge10', 'B01001Ge11', 'B01001Ge12', 'B01001Ge13', 'B01001Ge14', 'B01001Ge15', 'B01001Ge16', 'B01001Ge17', 'B01001Ge18', 'B01001Ge19', 'B01001Ge20', 'B01001Ge21', 'B01001Ge22', 'B01001Ge23', 'B01001Ge24', 'B01001Ge25', 'B01001Ge26', 'B01001Ge27', 'B01001Ge28', 'B01001Ge29', 'B01001Ge30', 'B01001Ge31', 'B01001He1', 'B01001He2', 'B01001He3', 'B01001He4', 'B01001He5', 'B01001He6', 'B01001He7', 'B01001He8', 'B01001He9', 'B01001He10', 'B01001He11', 'B01001He12', 'B01001He13', 'B01001He14', 'B01001He15', 'B01001He16', 'B01001He17', 'B01001He18', 'B01001He19', 'B01001He20', 'B01001He21', 'B01001He22', 'B01001He23', 'B01001He24', 'B01001He25', 'B01001He26', 'B01001He27', 'B01001He28', 'B01001He29', 'B01001He30', 'B01001He31', 'B01001Ie1', 'B01001Ie2', 'B01001Ie3', 'B01001Ie4', 'B01001Ie5', 'B01001Ie6', 'B01001Ie7', 'B01001Ie8', 'B01001Ie9', 'B01001Ie10', 'B01001Ie11', 'B01001Ie12', 'B01001Ie13', 'B01001Ie14', 'B01001Ie15', 'B01001Ie16', 'B01001Ie17', 'B01001Ie18', 'B01001Ie19', 'B01001Ie20', 'B01001Ie21', 'B01001Ie22', 'B01001Ie23', 'B01001Ie24', 'B01001Ie25', 'B01001Ie26', 'B01001Ie27', 'B01001Ie28', 'B01001Ie29', 'B01001Ie30', 'B01001Ie31', 'B01002e1', 'B01002e2', 'B01002e3', 'B01002Ae1', 'B01002Ae2', 'B01002Ae3', 'B01002Be1', 'B01002Be2', 'B01002Be3', 'B01002Ce1', 'B01002Ce2', 'B01002Ce3', 'B01002De1', 'B01002De2', 'B01002De3', 'B01002Ee1', 'B01002Ee2', 'B01002Ee3', 'B01002Fe1', 'B01002Fe2', 'B01002Fe3', 'B01002Ge1', 'B01002Ge2', 'B01002Ge3', 'B01002He1', 'B01002He2', 'B01002He3', 'B01002Ie1', 'B01002Ie2', 'B01002Ie3', 'B01003e1', 'M_0_9', 'M_10_14', 'M_15_17', 'M_18_21', 'F_0_9', 'F_10_14', 'F_15_17', 'F_18_21', 'ZCTA', 'M_0_21', 'F_0_21']
    


```python
# calculate white pediatric population by age group 0-19 or 0-24

df1["A_0_19"] = df1['B01001Ae3']+  df1['B01001Ae4']+ df1['B01001Ae5'] + df1['B01001Ae6'] +  df1['B01001Ae7']+ df1['B01001Ae18'] + df1['B01001Ae19'] +  df1['B01001Ae20']+ df1['B01001Ae21'] + df1['B01001Ae22']
df1["A_0_24"] = df1['B01001Ae3']+  df1['B01001Ae4']+ df1['B01001Ae5'] + df1['B01001Ae6'] +  df1['B01001Ae7']+  df1['B01001Ae8']+ df1['B01001Ae18'] + df1['B01001Ae19'] +  df1['B01001Ae20']+ df1['B01001Ae21'] + df1['B01001Ae22']+  df1['B01001Ae23']
```


```python
# calculate black pediatric population by age group 0-19 or 0-24
df1["B_0_19"] = df1['B01001Be3'] +  df1['B01001Be4']  +  df1['B01001Be5'] +  df1['B01001Be6']  +  df1['B01001Be7'] +  df1['B01001Be18']  +  df1['B01001Be19'] +  df1['B01001Be20'] +  df1['B01001Be21'] +  df1['B01001Be22']
df1["B_0_24"] = df1['B01001Be3'] +  df1['B01001Be4']  +  df1['B01001Be5'] +  df1['B01001Be6']  +  df1['B01001Be7'] +  df1['B01001Be8']+  df1['B01001Be18']  +  df1['B01001Be19'] +  df1['B01001Be20'] +  df1['B01001Be21'] +  df1['B01001Be22']+  df1['B01001Be23']

```


```python
# calculate Hispanic pediatric population by age group 0-19 or 0-24
df1["H_0_19"] = df1['B01001Ie3'] + df1['B01001Ie4'] + df1['B01001Ie5'] + df1['B01001Ie6'] + df1['B01001Ie7'] + df1['B01001Ie18'] + df1['B01001Ie19'] + df1['B01001Ie20'] + df1['B01001Ie21'] + df1['B01001Ie22'] 
df1["H_0_24"] = df1['B01001Ie3'] + df1['B01001Ie4'] + df1['B01001Ie5'] + df1['B01001Ie6'] + df1['B01001Ie7'] + df1['B01001Ie8'] + df1['B01001Ie18'] + df1['B01001Ie19'] + df1['B01001Ie20'] + df1['B01001Ie21'] + df1['B01001Ie22'] + df1['B01001Ie23']
```


```python
# calculate Asian pediatric population by age group 0-19 or 0-24
df1["As_0_19"] = df1['B01001De3'] + df1['B01001De4'] +df1['B01001De5'] +df1['B01001De6'] +df1['B01001De7'] +df1['B01001De18'] +df1['B01001De19'] +df1['B01001De20'] +df1['B01001De21'] +df1['B01001De22'] 
df1["As_0_24"] = df1['B01001De3'] + df1['B01001De4'] +df1['B01001De5'] +df1['B01001De6'] +df1['B01001De7'] +df1['B01001De8']+df1['B01001De18'] +df1['B01001De19'] +df1['B01001De20'] +df1['B01001De21'] +df1['B01001De22']+df1['B01001De23']
```


```python
# calculate Native American pediatric population by age group 0-19 or 0-24
df1["Na_0_19"] = df1['B01001Ce3'] + df1['B01001Ce4'] + df1['B01001Ce5'] + df1['B01001Ce6'] + df1['B01001Ce7'] + df1['B01001Ce18'] + df1['B01001Ce19'] + df1['B01001Ce20'] + df1['B01001Ce21'] + df1['B01001Ce22']  
df1["Na_0_24"] = df1['B01001Ce3'] + df1['B01001Ce4'] + df1['B01001Ce5'] + df1['B01001Ce6'] + df1['B01001Ce7'] + df1['B01001Ce8'] +df1['B01001Ce18'] + df1['B01001Ce19'] + df1['B01001Ce20'] + df1['B01001Ce21'] + df1['B01001Ce22']+ df1['B01001Ce23']
```


```python
print(len(list(df1.columns)))
```

    382
    


```python
#exclude the raw fields, only keep the calculated fields, OBJECTID, GEOID,
raw_cols = [col for col in df1.columns if 'B0100' in col]
df2 = df1.drop(raw_cols, axis=1)
print(list(df2.columns))
```

    ['OBJECTID', 'GEOID', 'M_0_9', 'M_10_14', 'M_15_17', 'M_18_21', 'F_0_9', 'F_10_14', 'F_15_17', 'F_18_21', 'ZCTA', 'M_0_21', 'F_0_21', 'A_0_19', 'A_0_24', 'B_0_19', 'B_0_24', 'H_0_19', 'H_0_24', 'As_0_19', 'As_0_24', 'Na_0_19', 'Na_0_24']
    


```python
import pandas as pd

#import health dataset
df_h = pd.read_csv(r'C:\Users\u6037208\Box\Pediatric_Cancer_care\National pediatric cancer care locations\GIS_analysis\ZCTA_demographics\health_insurance.csv')

margin_cols_h = [col for col in df_h.columns if 'm' in col]

print(margin_cols_h)
```

    ['B27001m1', 'B27001m2', 'B27001m3', 'B27001m4', 'B27001m5', 'B27001m6', 'B27001m7', 'B27001m8', 'B27001m9', 'B27001m10', 'B27001m11', 'B27001m12', 'B27001m13', 'B27001m14', 'B27001m15', 'B27001m16', 'B27001m17', 'B27001m18', 'B27001m19', 'B27001m20', 'B27001m21', 'B27001m22', 'B27001m23', 'B27001m24', 'B27001m25', 'B27001m26', 'B27001m27', 'B27001m28', 'B27001m29', 'B27001m30', 'B27001m31', 'B27001m32', 'B27001m33', 'B27001m34', 'B27001m35', 'B27001m36', 'B27001m37', 'B27001m38', 'B27001m39', 'B27001m40', 'B27001m41', 'B27001m42', 'B27001m43', 'B27001m44', 'B27001m45', 'B27001m46', 'B27001m47', 'B27001m48', 'B27001m49', 'B27001m50', 'B27001m51', 'B27001m52', 'B27001m53', 'B27001m54', 'B27001m55', 'B27001m56', 'B27001m57', 'B27002m1', 'B27002m2', 'B27002m3', 'B27002m4', 'B27002m5', 'B27002m6', 'B27002m7', 'B27002m8', 'B27002m9', 'B27002m10', 'B27002m11', 'B27002m12', 'B27002m13', 'B27002m14', 'B27002m15', 'B27002m16', 'B27002m17', 'B27002m18', 'B27002m19', 'B27002m20', 'B27002m21', 'B27002m22', 'B27002m23', 'B27002m24', 'B27002m25', 'B27002m26', 'B27002m27', 'B27002m28', 'B27002m29', 'B27002m30', 'B27002m31', 'B27002m32', 'B27002m33', 'B27002m34', 'B27002m35', 'B27002m36', 'B27002m37', 'B27002m38', 'B27002m39', 'B27002m40', 'B27002m41', 'B27002m42', 'B27002m43', 'B27002m44', 'B27002m45', 'B27002m46', 'B27002m47', 'B27002m48', 'B27002m49', 'B27002m50', 'B27002m51', 'B27002m52', 'B27002m53', 'B27002m54', 'B27002m55', 'B27002m56', 'B27002m57', 'C27001Am1', 'C27001Am2', 'C27001Am3', 'C27001Am4', 'C27001Am5', 'C27001Am6', 'C27001Am7', 'C27001Am8', 'C27001Am9', 'C27001Am10', 'C27001Bm1', 'C27001Bm2', 'C27001Bm3', 'C27001Bm4', 'C27001Bm5', 'C27001Bm6', 'C27001Bm7', 'C27001Bm8', 'C27001Bm9', 'C27001Bm10', 'C27001Cm1', 'C27001Cm2', 'C27001Cm3', 'C27001Cm4', 'C27001Cm5', 'C27001Cm6', 'C27001Cm7', 'C27001Cm8', 'C27001Cm9', 'C27001Cm10', 'C27001Dm1', 'C27001Dm2', 'C27001Dm3', 'C27001Dm4', 'C27001Dm5', 'C27001Dm6', 'C27001Dm7', 'C27001Dm8', 'C27001Dm9', 'C27001Dm10', 'C27001Em1', 'C27001Em2', 'C27001Em3', 'C27001Em4', 'C27001Em5', 'C27001Em6', 'C27001Em7', 'C27001Em8', 'C27001Em9', 'C27001Em10', 'C27001Fm1', 'C27001Fm2', 'C27001Fm3', 'C27001Fm4', 'C27001Fm5', 'C27001Fm6', 'C27001Fm7', 'C27001Fm8', 'C27001Fm9', 'C27001Fm10', 'C27001Gm1', 'C27001Gm2', 'C27001Gm3', 'C27001Gm4', 'C27001Gm5', 'C27001Gm6', 'C27001Gm7', 'C27001Gm8', 'C27001Gm9', 'C27001Gm10', 'C27001Hm1', 'C27001Hm2', 'C27001Hm3', 'C27001Hm4', 'C27001Hm5', 'C27001Hm6', 'C27001Hm7', 'C27001Hm8', 'C27001Hm9', 'C27001Hm10', 'C27001Im1', 'C27001Im2', 'C27001Im3', 'C27001Im4', 'C27001Im5', 'C27001Im6', 'C27001Im7', 'C27001Im8', 'C27001Im9', 'C27001Im10', 'B27003m1', 'B27003m2', 'B27003m3', 'B27003m4', 'B27003m5', 'B27003m6', 'B27003m7', 'B27003m8', 'B27003m9', 'B27003m10', 'B27003m11', 'B27003m12', 'B27003m13', 'B27003m14', 'B27003m15', 'B27003m16', 'B27003m17', 'B27003m18', 'B27003m19', 'B27003m20', 'B27003m21', 'B27003m22', 'B27003m23', 'B27003m24', 'B27003m25', 'B27003m26', 'B27003m27', 'B27003m28', 'B27003m29', 'B27003m30', 'B27003m31', 'B27003m32', 'B27003m33', 'B27003m34', 'B27003m35', 'B27003m36', 'B27003m37', 'B27003m38', 'B27003m39', 'B27003m40', 'B27003m41', 'B27003m42', 'B27003m43', 'B27003m44', 'B27003m45', 'B27003m46', 'B27003m47', 'B27003m48', 'B27003m49', 'B27003m50', 'B27003m51', 'B27003m52', 'B27003m53', 'B27003m54', 'B27003m55', 'B27003m56', 'B27003m57', 'C27004m1', 'C27004m2', 'C27004m3', 'C27004m4', 'C27004m5', 'C27004m6', 'C27004m7', 'C27004m8', 'C27004m9', 'C27004m10', 'C27004m11', 'C27004m12', 'C27004m13', 'C27004m14', 'C27004m15', 'C27004m16', 'C27004m17', 'C27004m18', 'C27004m19', 'C27004m20', 'C27004m21', 'C27005m1', 'C27005m2', 'C27005m3', 'C27005m4', 'C27005m5', 'C27005m6', 'C27005m7', 'C27005m8', 'C27005m9', 'C27005m10', 'C27005m11', 'C27005m12', 'C27005m13', 'C27005m14', 'C27005m15', 'C27005m16', 'C27005m17', 'C27005m18', 'C27005m19', 'C27005m20', 'C27005m21', 'C27006m1', 'C27006m2', 'C27006m3', 'C27006m4', 'C27006m5', 'C27006m6', 'C27006m7', 'C27006m8', 'C27006m9', 'C27006m10', 'C27006m11', 'C27006m12', 'C27006m13', 'C27006m14', 'C27006m15', 'C27006m16', 'C27006m17', 'C27006m18', 'C27006m19', 'C27006m20', 'C27006m21', 'C27007m1', 'C27007m2', 'C27007m3', 'C27007m4', 'C27007m5', 'C27007m6', 'C27007m7', 'C27007m8', 'C27007m9', 'C27007m10', 'C27007m11', 'C27007m12', 'C27007m13', 'C27007m14', 'C27007m15', 'C27007m16', 'C27007m17', 'C27007m18', 'C27007m19', 'C27007m20', 'C27007m21', 'C27008m1', 'C27008m2', 'C27008m3', 'C27008m4', 'C27008m5', 'C27008m6', 'C27008m7', 'C27008m8', 'C27008m9', 'C27008m10', 'C27008m11', 'C27008m12', 'C27008m13', 'C27008m14', 'C27008m15', 'C27008m16', 'C27008m17', 'C27008m18', 'C27008m19', 'C27008m20', 'C27008m21', 'C27009m1', 'C27009m2', 'C27009m3', 'C27009m4', 'C27009m5', 'C27009m6', 'C27009m7', 'C27009m8', 'C27009m9', 'C27009m10', 'C27009m11', 'C27009m12', 'C27009m13', 'C27009m14', 'C27009m15', 'C27009m16', 'C27009m17', 'C27009m18', 'C27009m19', 'C27009m20', 'C27009m21', 'B27010m1', 'B27010m2', 'B27010m3', 'B27010m4', 'B27010m5', 'B27010m6', 'B27010m7', 'B27010m8', 'B27010m9', 'B27010m10', 'B27010m11', 'B27010m12', 'B27010m13', 'B27010m14', 'B27010m15', 'B27010m16', 'B27010m17', 'B27010m18', 'B27010m19', 'B27010m20', 'B27010m21', 'B27010m22', 'B27010m23', 'B27010m24', 'B27010m25', 'B27010m26', 'B27010m27', 'B27010m28', 'B27010m29', 'B27010m30', 'B27010m31', 'B27010m32', 'B27010m33', 'B27010m34', 'B27010m35', 'B27010m36', 'B27010m37', 'B27010m38', 'B27010m39', 'B27010m40', 'B27010m41', 'B27010m42', 'B27010m43', 'B27010m44', 'B27010m45', 'B27010m46', 'B27010m47', 'B27010m48', 'B27010m49', 'B27010m50', 'B27010m51', 'B27010m52', 'B27010m53', 'B27010m54', 'B27010m55', 'B27010m56', 'B27010m57', 'B27010m58', 'B27010m59', 'B27010m60', 'B27010m61', 'B27010m62', 'B27010m63', 'B27010m64', 'B27010m65', 'B27010m66', 'B27011m1', 'B27011m2', 'B27011m3', 'B27011m4', 'B27011m5', 'B27011m6', 'B27011m7', 'B27011m8', 'B27011m9', 'B27011m10', 'B27011m11', 'B27011m12', 'B27011m13', 'B27011m14', 'B27011m15', 'B27011m16', 'B27011m17', 'B27015m1', 'B27015m2', 'B27015m3', 'B27015m4', 'B27015m5', 'B27015m6', 'B27015m7', 'B27015m8', 'B27015m9', 'B27015m10', 'B27015m11', 'B27015m12', 'B27015m13', 'B27015m14', 'B27015m15', 'B27015m16', 'B27015m17', 'B27015m18', 'B27015m19', 'B27015m20', 'B27015m21', 'B27015m22', 'B27015m23', 'B27015m24', 'B27015m25', 'B27015m26', 'C27012m1', 'C27012m2', 'C27012m3', 'C27012m4', 'C27012m5', 'C27012m6', 'C27012m7', 'C27012m8', 'C27012m9', 'C27012m10', 'C27012m11', 'C27012m12', 'C27012m13', 'C27012m14', 'C27012m15', 'C27012m16', 'C27012m17', 'C27012m18', 'C27012m19', 'C27012m20', 'C27012m21', 'C27012m22', 'C27013m1', 'C27013m2', 'C27013m3', 'C27013m4', 'C27013m5', 'C27013m6', 'C27013m7', 'C27013m8', 'C27013m9', 'C27013m10', 'C27014m1', 'C27014m2', 'C27014m3', 'C27014m4', 'C27014m5', 'C27014m6', 'C27014m7', 'C27014m8', 'C27014m9', 'C27014m10', 'C27016m1', 'C27016m2', 'C27016m3', 'C27016m4', 'C27016m5', 'C27016m6', 'C27016m7', 'C27016m8', 'C27016m9', 'C27016m10', 'C27016m11', 'C27016m12', 'C27016m13', 'C27016m14', 'C27016m15', 'C27016m16', 'C27016m17', 'C27016m18', 'C27016m19', 'C27016m20', 'C27016m21', 'C27016m22', 'C27016m23', 'C27016m24', 'C27016m25', 'C27016m26', 'C27016m27', 'C27016m28', 'C27016m29', 'C27016m30', 'C27016m31', 'C27016m32', 'C27016m33', 'C27016m34', 'C27016m35', 'C27016m36', 'C27016m37', 'C27016m38', 'C27016m39', 'C27016m40', 'C27016m41', 'C27016m42', 'C27016m43', 'C27016m44', 'C27016m45', 'C27016m46', 'C27016m47', 'C27016m48', 'C27016m49', 'C27016m50', 'C27016m51', 'B27019m1', 'B27019m2', 'B27019m3', 'B27019m4', 'B27019m5', 'B27019m6', 'B27019m7', 'B27019m8', 'B27019m9', 'B27019m10', 'B27019m11', 'B27019m12', 'B27019m13', 'B27019m14', 'B27019m15', 'B27019m16', 'B27019m17', 'B27019m18', 'B27019m19', 'B27019m20', 'B27019m21', 'B27019m22', 'B27019m23', 'B27019m24', 'B27019m25', 'B27019m26', 'B27019m27', 'B27019m28', 'B27019m29', 'B27019m30', 'B27019m31', 'B27019m32', 'B27019m33', 'B27019m34', 'B27019m35', 'B27019m36', 'B27019m37', 'B27019m38', 'B27019m39', 'B27019m40', 'B27019m41', 'B27019m42', 'B27019m43', 'B27020m1', 'B27020m2', 'B27020m3', 'B27020m4', 'B27020m5', 'B27020m6', 'B27020m7', 'B27020m8', 'B27020m9', 'B27020m10', 'B27020m11', 'B27020m12', 'B27020m13', 'B27020m14', 'B27020m15', 'B27020m16', 'B27020m17', 'B27022m1', 'B27022m2', 'B27022m3', 'B27022m4', 'B27022m5', 'B27022m6', 'B27022m7', 'B27022m8', 'B27022m9', 'B27022m10', 'B27022m11', 'B27022m12', 'B27022m13', 'B27022m14', 'B27022m15', 'B27023m1', 'B27023m2', 'B27023m3', 'B27023m4', 'B27023m5', 'B27023m6', 'B27023m7', 'B27023m8', 'B27023m9', 'B27023m10', 'B27023m11', 'B27023m12', 'B27023m13', 'B27023m14', 'B27023m15', 'C27017m1', 'C27017m2', 'C27017m3', 'C27017m4', 'C27017m5', 'C27017m6', 'C27017m7', 'C27017m8', 'C27017m9', 'C27017m10', 'C27017m11', 'C27017m12', 'C27017m13', 'C27017m14', 'C27017m15', 'C27017m16', 'C27017m17', 'C27017m18', 'C27017m19', 'C27017m20', 'C27017m21', 'C27017m22', 'C27017m23', 'C27017m24', 'C27017m25', 'C27017m26', 'C27017m27', 'C27017m28', 'C27017m29', 'C27017m30', 'C27017m31', 'C27017m32', 'C27017m33', 'C27017m34', 'C27017m35', 'C27017m36', 'C27017m37', 'C27017m38', 'C27017m39', 'C27017m40', 'C27017m41', 'C27017m42', 'C27017m43', 'C27017m44', 'C27017m45', 'C27017m46', 'C27017m47', 'C27017m48', 'C27017m49', 'C27017m50', 'C27017m51', 'C27018m1', 'C27018m2', 'C27018m3', 'C27018m4', 'C27018m5', 'C27018m6', 'C27018m7', 'C27018m8', 'C27018m9', 'C27018m10', 'C27018m11', 'C27018m12', 'C27018m13', 'C27018m14', 'C27018m15', 'C27018m16', 'C27018m17', 'C27018m18', 'C27018m19', 'C27018m20', 'C27018m21', 'C27018m22', 'C27018m23', 'C27018m24', 'C27018m25', 'C27018m26', 'C27018m27', 'C27018m28', 'C27018m29', 'C27018m30', 'C27018m31', 'C27018m32', 'C27018m33', 'C27018m34', 'C27018m35', 'C27018m36', 'C27018m37', 'C27018m38', 'C27018m39', 'C27018m40', 'C27018m41', 'C27018m42', 'C27018m43', 'C27018m44', 'C27018m45', 'C27018m46', 'C27018m47', 'C27018m48', 'C27018m49', 'C27018m50', 'C27018m51', 'C27021m1', 'C27021m2', 'C27021m3', 'C27021m4', 'C27021m5', 'C27021m6', 'C27021m7', 'C27021m8', 'C27021m9', 'C27021m10', 'C27021m11', 'C27021m12', 'C27021m13', 'C27021m14', 'C27021m15']
    


```python

df_h_1 = df_h.drop(margin_cols_h, axis=1)
print(list(df_h_1.columns))
```

    ['OBJECTID', 'GEOID', 'B27001e1', 'B27001e2', 'B27001e3', 'B27001e4', 'B27001e5', 'B27001e6', 'B27001e7', 'B27001e8', 'B27001e9', 'B27001e10', 'B27001e11', 'B27001e12', 'B27001e13', 'B27001e14', 'B27001e15', 'B27001e16', 'B27001e17', 'B27001e18', 'B27001e19', 'B27001e20', 'B27001e21', 'B27001e22', 'B27001e23', 'B27001e24', 'B27001e25', 'B27001e26', 'B27001e27', 'B27001e28', 'B27001e29', 'B27001e30', 'B27001e31', 'B27001e32', 'B27001e33', 'B27001e34', 'B27001e35', 'B27001e36', 'B27001e37', 'B27001e38', 'B27001e39', 'B27001e40', 'B27001e41', 'B27001e42', 'B27001e43', 'B27001e44', 'B27001e45', 'B27001e46', 'B27001e47', 'B27001e48', 'B27001e49', 'B27001e50', 'B27001e51', 'B27001e52', 'B27001e53', 'B27001e54', 'B27001e55', 'B27001e56', 'B27001e57', 'B27002e1', 'B27002e2', 'B27002e3', 'B27002e4', 'B27002e5', 'B27002e6', 'B27002e7', 'B27002e8', 'B27002e9', 'B27002e10', 'B27002e11', 'B27002e12', 'B27002e13', 'B27002e14', 'B27002e15', 'B27002e16', 'B27002e17', 'B27002e18', 'B27002e19', 'B27002e20', 'B27002e21', 'B27002e22', 'B27002e23', 'B27002e24', 'B27002e25', 'B27002e26', 'B27002e27', 'B27002e28', 'B27002e29', 'B27002e30', 'B27002e31', 'B27002e32', 'B27002e33', 'B27002e34', 'B27002e35', 'B27002e36', 'B27002e37', 'B27002e38', 'B27002e39', 'B27002e40', 'B27002e41', 'B27002e42', 'B27002e43', 'B27002e44', 'B27002e45', 'B27002e46', 'B27002e47', 'B27002e48', 'B27002e49', 'B27002e50', 'B27002e51', 'B27002e52', 'B27002e53', 'B27002e54', 'B27002e55', 'B27002e56', 'B27002e57', 'C27001Ae1', 'C27001Ae2', 'C27001Ae3', 'C27001Ae4', 'C27001Ae5', 'C27001Ae6', 'C27001Ae7', 'C27001Ae8', 'C27001Ae9', 'C27001Ae10', 'C27001Be1', 'C27001Be2', 'C27001Be3', 'C27001Be4', 'C27001Be5', 'C27001Be6', 'C27001Be7', 'C27001Be8', 'C27001Be9', 'C27001Be10', 'C27001Ce1', 'C27001Ce2', 'C27001Ce3', 'C27001Ce4', 'C27001Ce5', 'C27001Ce6', 'C27001Ce7', 'C27001Ce8', 'C27001Ce9', 'C27001Ce10', 'C27001De1', 'C27001De2', 'C27001De3', 'C27001De4', 'C27001De5', 'C27001De6', 'C27001De7', 'C27001De8', 'C27001De9', 'C27001De10', 'C27001Ee1', 'C27001Ee2', 'C27001Ee3', 'C27001Ee4', 'C27001Ee5', 'C27001Ee6', 'C27001Ee7', 'C27001Ee8', 'C27001Ee9', 'C27001Ee10', 'C27001Fe1', 'C27001Fe2', 'C27001Fe3', 'C27001Fe4', 'C27001Fe5', 'C27001Fe6', 'C27001Fe7', 'C27001Fe8', 'C27001Fe9', 'C27001Fe10', 'C27001Ge1', 'C27001Ge2', 'C27001Ge3', 'C27001Ge4', 'C27001Ge5', 'C27001Ge6', 'C27001Ge7', 'C27001Ge8', 'C27001Ge9', 'C27001Ge10', 'C27001He1', 'C27001He2', 'C27001He3', 'C27001He4', 'C27001He5', 'C27001He6', 'C27001He7', 'C27001He8', 'C27001He9', 'C27001He10', 'C27001Ie1', 'C27001Ie2', 'C27001Ie3', 'C27001Ie4', 'C27001Ie5', 'C27001Ie6', 'C27001Ie7', 'C27001Ie8', 'C27001Ie9', 'C27001Ie10', 'B27003e1', 'B27003e2', 'B27003e3', 'B27003e4', 'B27003e5', 'B27003e6', 'B27003e7', 'B27003e8', 'B27003e9', 'B27003e10', 'B27003e11', 'B27003e12', 'B27003e13', 'B27003e14', 'B27003e15', 'B27003e16', 'B27003e17', 'B27003e18', 'B27003e19', 'B27003e20', 'B27003e21', 'B27003e22', 'B27003e23', 'B27003e24', 'B27003e25', 'B27003e26', 'B27003e27', 'B27003e28', 'B27003e29', 'B27003e30', 'B27003e31', 'B27003e32', 'B27003e33', 'B27003e34', 'B27003e35', 'B27003e36', 'B27003e37', 'B27003e38', 'B27003e39', 'B27003e40', 'B27003e41', 'B27003e42', 'B27003e43', 'B27003e44', 'B27003e45', 'B27003e46', 'B27003e47', 'B27003e48', 'B27003e49', 'B27003e50', 'B27003e51', 'B27003e52', 'B27003e53', 'B27003e54', 'B27003e55', 'B27003e56', 'B27003e57', 'C27004e1', 'C27004e2', 'C27004e3', 'C27004e4', 'C27004e5', 'C27004e6', 'C27004e7', 'C27004e8', 'C27004e9', 'C27004e10', 'C27004e11', 'C27004e12', 'C27004e13', 'C27004e14', 'C27004e15', 'C27004e16', 'C27004e17', 'C27004e18', 'C27004e19', 'C27004e20', 'C27004e21', 'C27005e1', 'C27005e2', 'C27005e3', 'C27005e4', 'C27005e5', 'C27005e6', 'C27005e7', 'C27005e8', 'C27005e9', 'C27005e10', 'C27005e11', 'C27005e12', 'C27005e13', 'C27005e14', 'C27005e15', 'C27005e16', 'C27005e17', 'C27005e18', 'C27005e19', 'C27005e20', 'C27005e21', 'C27006e1', 'C27006e2', 'C27006e3', 'C27006e4', 'C27006e5', 'C27006e6', 'C27006e7', 'C27006e8', 'C27006e9', 'C27006e10', 'C27006e11', 'C27006e12', 'C27006e13', 'C27006e14', 'C27006e15', 'C27006e16', 'C27006e17', 'C27006e18', 'C27006e19', 'C27006e20', 'C27006e21', 'C27007e1', 'C27007e2', 'C27007e3', 'C27007e4', 'C27007e5', 'C27007e6', 'C27007e7', 'C27007e8', 'C27007e9', 'C27007e10', 'C27007e11', 'C27007e12', 'C27007e13', 'C27007e14', 'C27007e15', 'C27007e16', 'C27007e17', 'C27007e18', 'C27007e19', 'C27007e20', 'C27007e21', 'C27008e1', 'C27008e2', 'C27008e3', 'C27008e4', 'C27008e5', 'C27008e6', 'C27008e7', 'C27008e8', 'C27008e9', 'C27008e10', 'C27008e11', 'C27008e12', 'C27008e13', 'C27008e14', 'C27008e15', 'C27008e16', 'C27008e17', 'C27008e18', 'C27008e19', 'C27008e20', 'C27008e21', 'C27009e1', 'C27009e2', 'C27009e3', 'C27009e4', 'C27009e5', 'C27009e6', 'C27009e7', 'C27009e8', 'C27009e9', 'C27009e10', 'C27009e11', 'C27009e12', 'C27009e13', 'C27009e14', 'C27009e15', 'C27009e16', 'C27009e17', 'C27009e18', 'C27009e19', 'C27009e20', 'C27009e21', 'B27010e1', 'B27010e2', 'B27010e3', 'B27010e4', 'B27010e5', 'B27010e6', 'B27010e7', 'B27010e8', 'B27010e9', 'B27010e10', 'B27010e11', 'B27010e12', 'B27010e13', 'B27010e14', 'B27010e15', 'B27010e16', 'B27010e17', 'B27010e18', 'B27010e19', 'B27010e20', 'B27010e21', 'B27010e22', 'B27010e23', 'B27010e24', 'B27010e25', 'B27010e26', 'B27010e27', 'B27010e28', 'B27010e29', 'B27010e30', 'B27010e31', 'B27010e32', 'B27010e33', 'B27010e34', 'B27010e35', 'B27010e36', 'B27010e37', 'B27010e38', 'B27010e39', 'B27010e40', 'B27010e41', 'B27010e42', 'B27010e43', 'B27010e44', 'B27010e45', 'B27010e46', 'B27010e47', 'B27010e48', 'B27010e49', 'B27010e50', 'B27010e51', 'B27010e52', 'B27010e53', 'B27010e54', 'B27010e55', 'B27010e56', 'B27010e57', 'B27010e58', 'B27010e59', 'B27010e60', 'B27010e61', 'B27010e62', 'B27010e63', 'B27010e64', 'B27010e65', 'B27010e66', 'B27011e1', 'B27011e2', 'B27011e3', 'B27011e4', 'B27011e5', 'B27011e6', 'B27011e7', 'B27011e8', 'B27011e9', 'B27011e10', 'B27011e11', 'B27011e12', 'B27011e13', 'B27011e14', 'B27011e15', 'B27011e16', 'B27011e17', 'B27015e1', 'B27015e2', 'B27015e3', 'B27015e4', 'B27015e5', 'B27015e6', 'B27015e7', 'B27015e8', 'B27015e9', 'B27015e10', 'B27015e11', 'B27015e12', 'B27015e13', 'B27015e14', 'B27015e15', 'B27015e16', 'B27015e17', 'B27015e18', 'B27015e19', 'B27015e20', 'B27015e21', 'B27015e22', 'B27015e23', 'B27015e24', 'B27015e25', 'B27015e26', 'C27012e1', 'C27012e2', 'C27012e3', 'C27012e4', 'C27012e5', 'C27012e6', 'C27012e7', 'C27012e8', 'C27012e9', 'C27012e10', 'C27012e11', 'C27012e12', 'C27012e13', 'C27012e14', 'C27012e15', 'C27012e16', 'C27012e17', 'C27012e18', 'C27012e19', 'C27012e20', 'C27012e21', 'C27012e22', 'C27013e1', 'C27013e2', 'C27013e3', 'C27013e4', 'C27013e5', 'C27013e6', 'C27013e7', 'C27013e8', 'C27013e9', 'C27013e10', 'C27014e1', 'C27014e2', 'C27014e3', 'C27014e4', 'C27014e5', 'C27014e6', 'C27014e7', 'C27014e8', 'C27014e9', 'C27014e10', 'C27016e1', 'C27016e2', 'C27016e3', 'C27016e4', 'C27016e5', 'C27016e6', 'C27016e7', 'C27016e8', 'C27016e9', 'C27016e10', 'C27016e11', 'C27016e12', 'C27016e13', 'C27016e14', 'C27016e15', 'C27016e16', 'C27016e17', 'C27016e18', 'C27016e19', 'C27016e20', 'C27016e21', 'C27016e22', 'C27016e23', 'C27016e24', 'C27016e25', 'C27016e26', 'C27016e27', 'C27016e28', 'C27016e29', 'C27016e30', 'C27016e31', 'C27016e32', 'C27016e33', 'C27016e34', 'C27016e35', 'C27016e36', 'C27016e37', 'C27016e38', 'C27016e39', 'C27016e40', 'C27016e41', 'C27016e42', 'C27016e43', 'C27016e44', 'C27016e45', 'C27016e46', 'C27016e47', 'C27016e48', 'C27016e49', 'C27016e50', 'C27016e51', 'B27019e1', 'B27019e2', 'B27019e3', 'B27019e4', 'B27019e5', 'B27019e6', 'B27019e7', 'B27019e8', 'B27019e9', 'B27019e10', 'B27019e11', 'B27019e12', 'B27019e13', 'B27019e14', 'B27019e15', 'B27019e16', 'B27019e17', 'B27019e18', 'B27019e19', 'B27019e20', 'B27019e21', 'B27019e22', 'B27019e23', 'B27019e24', 'B27019e25', 'B27019e26', 'B27019e27', 'B27019e28', 'B27019e29', 'B27019e30', 'B27019e31', 'B27019e32', 'B27019e33', 'B27019e34', 'B27019e35', 'B27019e36', 'B27019e37', 'B27019e38', 'B27019e39', 'B27019e40', 'B27019e41', 'B27019e42', 'B27019e43', 'B27020e1', 'B27020e2', 'B27020e3', 'B27020e4', 'B27020e5', 'B27020e6', 'B27020e7', 'B27020e8', 'B27020e9', 'B27020e10', 'B27020e11', 'B27020e12', 'B27020e13', 'B27020e14', 'B27020e15', 'B27020e16', 'B27020e17', 'B27022e1', 'B27022e2', 'B27022e3', 'B27022e4', 'B27022e5', 'B27022e6', 'B27022e7', 'B27022e8', 'B27022e9', 'B27022e10', 'B27022e11', 'B27022e12', 'B27022e13', 'B27022e14', 'B27022e15', 'B27023e1', 'B27023e2', 'B27023e3', 'B27023e4', 'B27023e5', 'B27023e6', 'B27023e7', 'B27023e8', 'B27023e9', 'B27023e10', 'B27023e11', 'B27023e12', 'B27023e13', 'B27023e14', 'B27023e15', 'C27017e1', 'C27017e2', 'C27017e3', 'C27017e4', 'C27017e5', 'C27017e6', 'C27017e7', 'C27017e8', 'C27017e9', 'C27017e10', 'C27017e11', 'C27017e12', 'C27017e13', 'C27017e14', 'C27017e15', 'C27017e16', 'C27017e17', 'C27017e18', 'C27017e19', 'C27017e20', 'C27017e21', 'C27017e22', 'C27017e23', 'C27017e24', 'C27017e25', 'C27017e26', 'C27017e27', 'C27017e28', 'C27017e29', 'C27017e30', 'C27017e31', 'C27017e32', 'C27017e33', 'C27017e34', 'C27017e35', 'C27017e36', 'C27017e37', 'C27017e38', 'C27017e39', 'C27017e40', 'C27017e41', 'C27017e42', 'C27017e43', 'C27017e44', 'C27017e45', 'C27017e46', 'C27017e47', 'C27017e48', 'C27017e49', 'C27017e50', 'C27017e51', 'C27018e1', 'C27018e2', 'C27018e3', 'C27018e4', 'C27018e5', 'C27018e6', 'C27018e7', 'C27018e8', 'C27018e9', 'C27018e10', 'C27018e11', 'C27018e12', 'C27018e13', 'C27018e14', 'C27018e15', 'C27018e16', 'C27018e17', 'C27018e18', 'C27018e19', 'C27018e20', 'C27018e21', 'C27018e22', 'C27018e23', 'C27018e24', 'C27018e25', 'C27018e26', 'C27018e27', 'C27018e28', 'C27018e29', 'C27018e30', 'C27018e31', 'C27018e32', 'C27018e33', 'C27018e34', 'C27018e35', 'C27018e36', 'C27018e37', 'C27018e38', 'C27018e39', 'C27018e40', 'C27018e41', 'C27018e42', 'C27018e43', 'C27018e44', 'C27018e45', 'C27018e46', 'C27018e47', 'C27018e48', 'C27018e49', 'C27018e50', 'C27018e51', 'C27021e1', 'C27021e2', 'C27021e3', 'C27021e4', 'C27021e5', 'C27021e6', 'C27021e7', 'C27021e8', 'C27021e9', 'C27021e10', 'C27021e11', 'C27021e12', 'C27021e13', 'C27021e14', 'C27021e15']
    


```python
# Calculate the pediatric population with health insurance for males and females
df_h_1["M_H_Ins_0_18"] = df_h_1["B27001e4"] =  df_h_1["B27001e7"]
df_h_1["M_H_Ins_0_25"] = df_h_1["B27001e4"] =  df_h_1["B27001e7"] + df_h_1["B27001e10"]

df_h_1["F_H_Ins_0_18"] = df_h_1["B27001e32"] =  df_h_1["B27001e35"]
df_h_1["F_H_Ins_0_25"] = df_h_1["B27001e32"] =  df_h_1["B27001e35"] + df_h_1["B27001e38"]

```


```python
#exclude the raw fields, only keep the calculated fields, OBJECTID, GEOID,
raw_cols_h = [col for col in df_h_1.columns if 'B27' in col or 'C27' in col]
df_h_2 = df_h_1.drop(raw_cols_h, axis=1)
print(list(df_h_2.columns))
```

    ['OBJECTID', 'GEOID', 'M_H_Ins_0_18', 'M_H_Ins_0_25', 'F_H_Ins_0_18', 'F_H_Ins_0_25']
    


```python
# merge the demographics, health insurance demographics
merged_df = pd.merge(df2, df_h_2, on="GEOID")
merged_df.head()

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OBJECTID_x</th>
      <th>GEOID</th>
      <th>M_0_9</th>
      <th>M_10_14</th>
      <th>M_15_17</th>
      <th>M_18_21</th>
      <th>F_0_9</th>
      <th>F_10_14</th>
      <th>F_15_17</th>
      <th>F_18_21</th>
      <th>...</th>
      <th>H_0_24</th>
      <th>As_0_19</th>
      <th>As_0_24</th>
      <th>Na_0_19</th>
      <th>Na_0_24</th>
      <th>OBJECTID_y</th>
      <th>M_H_Ins_0_18</th>
      <th>M_H_Ins_0_25</th>
      <th>F_H_Ins_0_18</th>
      <th>F_H_Ins_0_25</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>86000US00601</td>
      <td>1030</td>
      <td>640</td>
      <td>333</td>
      <td>402</td>
      <td>608</td>
      <td>630</td>
      <td>319</td>
      <td>546</td>
      <td>...</td>
      <td>5164</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>1385.0</td>
      <td>2123.0</td>
      <td>1329.0</td>
      <td>2053.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>86000US00602</td>
      <td>1968</td>
      <td>826</td>
      <td>718</td>
      <td>1163</td>
      <td>1593</td>
      <td>1105</td>
      <td>673</td>
      <td>1232</td>
      <td>...</td>
      <td>9761</td>
      <td>0</td>
      <td>0</td>
      <td>18</td>
      <td>18</td>
      <td>2</td>
      <td>2745.0</td>
      <td>4285.0</td>
      <td>2529.0</td>
      <td>4139.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>86000US00603</td>
      <td>2265</td>
      <td>1507</td>
      <td>1026</td>
      <td>1354</td>
      <td>2059</td>
      <td>1610</td>
      <td>710</td>
      <td>1260</td>
      <td>...</td>
      <td>13110</td>
      <td>23</td>
      <td>23</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3902.0</td>
      <td>5816.0</td>
      <td>3369.0</td>
      <td>5303.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>86000US00606</td>
      <td>283</td>
      <td>194</td>
      <td>144</td>
      <td>208</td>
      <td>291</td>
      <td>174</td>
      <td>100</td>
      <td>183</td>
      <td>...</td>
      <td>1824</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>449.0</td>
      <td>781.0</td>
      <td>421.0</td>
      <td>720.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>86000US00610</td>
      <td>1238</td>
      <td>805</td>
      <td>537</td>
      <td>711</td>
      <td>1133</td>
      <td>797</td>
      <td>493</td>
      <td>683</td>
      <td>...</td>
      <td>7246</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>2148.0</td>
      <td>3370.0</td>
      <td>1962.0</td>
      <td>3204.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>




```python
merged_df.to_csv("ped_demo_health.csv")
```


```python
# clean the ADI data, calculate the average ZIP Code-level ADI from all 9-digit ZIP Code-level estimates 
# within a given 5-digit ZIP Code (ref).
az_adi = pd.read_csv(r'C:\Users\u6037208\Box\Pediatric_Cancer_care\Uran_Rural\ADI_each state_Zip_to_ZCTA\AK\AZ_2019_ADI_9 Digit Zip Code_v3.1.txt', sep=",")
az_adi.head()
```

    C:\ProgramData\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3165: DtypeWarning: Columns (7,8) have mixed types.Specify dtype option on import or set low_memory=False.
      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>X</th>
      <th>TYPE</th>
      <th>ZIPID</th>
      <th>FIPS.x</th>
      <th>GISJOIN</th>
      <th>FIPS.y</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>P</td>
      <td>G850010001</td>
      <td>4.013114e+10</td>
      <td>G04001301141001</td>
      <td>4.013114e+10</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>P</td>
      <td>G850010002</td>
      <td>4.013114e+10</td>
      <td>G04001301141001</td>
      <td>4.013114e+10</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>P</td>
      <td>G850010003</td>
      <td>4.013114e+10</td>
      <td>G04001301141001</td>
      <td>4.013114e+10</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>P</td>
      <td>G850010004</td>
      <td>4.013114e+10</td>
      <td>G04001301141001</td>
      <td>4.013114e+10</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5</td>
      <td>P</td>
      <td>G850010005</td>
      <td>4.013114e+10</td>
      <td>G04001301141001</td>
      <td>4.013114e+10</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
  </tbody>
</table>
</div>




```python
# drop fields: FIPS.x, GISJOIN, FIPS.y, TYPE,X. Because only Zip code field will be used to join other layers later
az_adi.drop(columns=['X'], inplace = True)
az_adi.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>TYPE</th>
      <th>ZIPID</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>P</td>
      <td>G850010001</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>P</td>
      <td>G850010002</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>P</td>
      <td>G850010003</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>P</td>
      <td>G850010004</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>P</td>
      <td>G850010005</td>
      <td>GQ</td>
      <td>GQ</td>
    </tr>
  </tbody>
</table>
</div>




```python
az_adi['ZIP']= az_adi['ZIPID'].str[:6]
az_adi.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>TYPE</th>
      <th>ZIPID</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
      <th>ZIP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>P</td>
      <td>G850010001</td>
      <td>GQ</td>
      <td>GQ</td>
      <td>G85001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>P</td>
      <td>G850010002</td>
      <td>GQ</td>
      <td>GQ</td>
      <td>G85001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>P</td>
      <td>G850010003</td>
      <td>GQ</td>
      <td>GQ</td>
      <td>G85001</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>P</td>
      <td>G850010004</td>
      <td>GQ</td>
      <td>GQ</td>
      <td>G85001</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>P</td>
      <td>G850010005</td>
      <td>GQ</td>
      <td>GQ</td>
      <td>G85001</td>
    </tr>
  </tbody>
</table>
</div>




```python
set(az_adi["ADI_NATRANK"].values)
```




    {'1',
     '10',
     '100',
     '11',
     '12',
     '13',
     '14',
     '15',
     '16',
     '17',
     '18',
     '19',
     '2',
     '20',
     '21',
     '22',
     '23',
     '24',
     '25',
     '26',
     '27',
     '28',
     '29',
     '3',
     '30',
     '31',
     '32',
     '33',
     '34',
     '35',
     '36',
     '37',
     '38',
     '39',
     '4',
     '40',
     '41',
     '42',
     '43',
     '44',
     '45',
     '46',
     '47',
     '48',
     '49',
     '5',
     '50',
     '51',
     '52',
     '53',
     '54',
     '55',
     '56',
     '57',
     '58',
     '59',
     '6',
     '60',
     '61',
     '62',
     '63',
     '64',
     '65',
     '66',
     '67',
     '68',
     '69',
     '7',
     '70',
     '71',
     '72',
     '73',
     '74',
     '75',
     '76',
     '77',
     '78',
     '79',
     '8',
     '80',
     '81',
     '82',
     '83',
     '84',
     '85',
     '86',
     '87',
     '88',
     '89',
     '9',
     '90',
     '91',
     '92',
     '93',
     '94',
     '95',
     '96',
     '97',
     98,
     '98',
     99,
     '99',
     'GQ',
     'GQ-PH',
     'PH',
     'QDI',
     nan}




```python
# exclude the rows with special values in National Rank, so does the 
az_adi2 = az_adi[(az_adi["ADI_NATRANK"] !='GQ')& (az_adi["ADI_NATRANK"] !='GQ-PH')&(az_adi["ADI_NATRANK"] !='PH')&(az_adi["ADI_NATRANK"] !='QDI') &(az_adi["ADI_NATRANK"] != "nan")]
az_adi2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>TYPE</th>
      <th>ZIPID</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
      <th>ZIP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3989</th>
      <td>3990</td>
      <td>NaN</td>
      <td>G850030001</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3990</th>
      <td>3991</td>
      <td>NaN</td>
      <td>G850030002</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3991</th>
      <td>3992</td>
      <td>NaN</td>
      <td>G850030003</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3992</th>
      <td>3993</td>
      <td>NaN</td>
      <td>G850030004</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3993</th>
      <td>3994</td>
      <td>NaN</td>
      <td>G850030005</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
  </tbody>
</table>
</div>




```python
#az_adi2 = az_adi2.groupby("ZIP", as_index =False).agg({"ADI_NATRANK":"mean","ADI_STATERNK":"mean"})
az_adi2.drop(az_adi2.columns[[0]], axis = 1, inplace = True)
az_adi2.head()
```

    C:\ProgramData\Anaconda3\lib\site-packages\pandas\core\frame.py:4308: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      return super().drop(
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TYPE</th>
      <th>ZIPID</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
      <th>ZIP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3989</th>
      <td>NaN</td>
      <td>G850030001</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3990</th>
      <td>NaN</td>
      <td>G850030002</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3991</th>
      <td>NaN</td>
      <td>G850030003</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3992</th>
      <td>NaN</td>
      <td>G850030004</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3993</th>
      <td>NaN</td>
      <td>G850030005</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
  </tbody>
</table>
</div>




```python
az_adi2.drop(columns= ["TYPE"],  inplace = True)
az_adi2.head()
```

    C:\ProgramData\Anaconda3\lib\site-packages\pandas\core\frame.py:4308: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      return super().drop(
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ZIPID</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
      <th>ZIP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3989</th>
      <td>G850030001</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3990</th>
      <td>G850030002</td>
      <td>19</td>
      <td>2</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3991</th>
      <td>G850030003</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3992</th>
      <td>G850030004</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
    <tr>
      <th>3993</th>
      <td>G850030005</td>
      <td>16</td>
      <td>1</td>
      <td>G85003</td>
    </tr>
  </tbody>
</table>
</div>




```python
#az_adi2 = az_adi2.groupby("ZIP", as_index =False).agg({"ADI_NATRANK":"mean","ADI_STATERNK":"mean"})
az_adi2['ADI_NATRANK'] = pd.to_numeric(az_adi2['ADI_NATRANK'])
az_adi2['ADI_STATERNK'] = pd.to_numeric(az_adi2['ADI_STATERNK'])
```

    <ipython-input-55-ade4dc0328e2>:2: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      az_adi2['ADI_NATRANK'] = pd.to_numeric(az_adi2['ADI_NATRANK'])
    <ipython-input-55-ade4dc0328e2>:3: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      az_adi2['ADI_STATERNK'] = pd.to_numeric(az_adi2['ADI_STATERNK'])
    


```python
az_adi2 = az_adi2.groupby("ZIP", as_index =False).agg({"ADI_NATRANK":"mean","ADI_STATERNK":"mean"})
az_adi2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ZIP</th>
      <th>ADI_NATRANK</th>
      <th>ADI_STATERNK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>G85003</td>
      <td>48.979723</td>
      <td>5.083244</td>
    </tr>
    <tr>
      <th>1</th>
      <td>G85004</td>
      <td>43.824979</td>
      <td>4.582838</td>
    </tr>
    <tr>
      <th>2</th>
      <td>G85005</td>
      <td>94.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>G85006</td>
      <td>56.988487</td>
      <td>6.280780</td>
    </tr>
    <tr>
      <th>4</th>
      <td>G85007</td>
      <td>56.493081</td>
      <td>6.110701</td>
    </tr>
  </tbody>
</table>
</div>




```python
az_adi2.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 511 entries, 0 to 510
    Data columns (total 3 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   ZIP           511 non-null    object 
     1   ADI_NATRANK   509 non-null    float64
     2   ADI_STATERNK  509 non-null    float64
    dtypes: float64(2), object(1)
    memory usage: 16.0+ KB
    


```python
import os
# in_dir contains the ADI values for 49 states, excluding Alaska, Hawaii, and Port Rico
in_dir = r"C:\Users\u6037208\Box\Pediatric_Cancer_care\Uran_Rural\ADI_each state_Zip_to_ZCTA\all_states"

df_lst = []
for filename in os.listdir(in_dir):
    
    input_file = open(os.path.join(in_dir, filename),'r')
    
    # the first 2 character of filename is the state abbreviation, use that to distinguish each state
    df = filename[:2]
    df = pd.read_csv(input_file, sep = ",")
    # drop the columns that won't be used later, only keep zip code field
    df.drop(columns=["Unnamed: 0","X","TYPE","FIPS.x","GISJOIN", "FIPS.y"], inplace = True)
    # add a new field that is pure zip code, eliminating the last 4 digits of the 9-digit zip code
    df['ZIP']= df['ZIPID'].str[1:6]
    # delete rows with special ADI code instead of ADI ranks
    df2 = df[(df["ADI_NATRANK"] !='GQ')& (df["ADI_NATRANK"] !='GQ-PH')&(df["ADI_NATRANK"] !='PH')&(df["ADI_NATRANK"] !='QDI') &(df["ADI_NATRANK"] != "nan")&(df["ADI_NATRANK"] !='NONE')]

    # convert the numbers into numeric format
    df2['ADI_NATRANK'] = pd.to_numeric(df2['ADI_NATRANK'])
    df2['ADI_STATERNK'] = pd.to_numeric(df2['ADI_STATERNK'])
    
    # calculate the average ZIP Code-level ADI from all 9-digit ZIP Code-level estimates within a given 5-digit ZIP Code
    df2 = df2.groupby("ZIP", as_index =False).agg({"ADI_NATRANK":"mean","ADI_STATERNK":"mean"})
   
    # append the result of each state together
    df_lst.append(df2)
        
result = pd.concat(df_lst)
result.to_csv("ADI_49_states.csv")
result.info()
```

    <ipython-input-81-88c1666d23be>:18: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df2['ADI_NATRANK'] = pd.to_numeric(df2['ADI_NATRANK'])
    <ipython-input-81-88c1666d23be>:19: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      df2['ADI_STATERNK'] = pd.to_numeric(df2['ADI_STATERNK'])
    

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 39461 entries, 0 to 189
    Data columns (total 3 columns):
     #   Column        Non-Null Count  Dtype  
    ---  ------        --------------  -----  
     0   ZIP           39461 non-null  object 
     1   ADI_NATRANK   39444 non-null  float64
     2   ADI_STATERNK  39444 non-null  float64
    dtypes: float64(2), object(1)
    memory usage: 1.2+ MB
    


```python

```


```python

```
